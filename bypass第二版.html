<script>
    async function bypassUrl() {
        const urlInput = document.getElementById('urlInput');
        const output = document.getElementById('output');
        const url = urlInput.value.trim();

        if (!url) {
            alert('Please enter a URL');
            return;
        }

        // 显示加载状态
        output.value = "Processing...";

        try {
            // 使用CORS代理访问示例API（实际使用时需要替换为真实API）
            const proxy = 'https://cors-anywhere.herokuapp.com/';
            const apiUrl = `${proxy}https://your-real-bypass-api.com/bypass?url=${encodeURIComponent(url)}`;
            
            const response = await fetch(apiUrl, {
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            
            // 假设API返回结构 { destination: "..." }
            if (data.destination) {
                output.value = data.destination;
            } else {
                output.value = "No redirect destination found";
            }
        } catch (error) {
            output.value = `Error: ${error.message}`;
        }
    }

    function clearFields() {
        document.getElementById('urlInput').value = '';
        document.getElementById('output').value = '';
    }

    function navigateToResponse() {
        const outputUrl = document.getElementById('output').value.trim();
        
        if (!outputUrl) {
            alert('No URL available');
            return;
        }

        try {
            const validUrl = new URL(outputUrl);
            if (validUrl.protocol === 'http:' || validUrl.protocol === 'https:') {
                window.open(outputUrl, '_blank', 'noopener,noreferrer');
            } else {
                alert('Only HTTP/HTTPS URLs are allowed');
            }
        } catch (e) {
            alert('Invalid URL format');
        }
    }
</script>

